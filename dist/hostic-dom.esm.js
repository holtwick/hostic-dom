var W=Object.defineProperty,Ie=Object.prototype.hasOwnProperty,C=(e,t)=>()=>(t||(t={exports:{}},e(t.exports,t)),t.exports),ke=e=>W(e,"__esModule",{value:!0}),Re=(e,t)=>{if(ke(e),typeof t=="object"||typeof t=="function")for(let r in t)!Ie.call(e,r)&&r!=="default"&&W(e,r,{get:()=>t[r],enumerable:!0});return e},$e=e=>e&&e.__esModule?e:Re(W({},"default",{value:e,enumerable:!0}),e);var z=C(X=>{"use strict";Object.defineProperty(X,"__esModule",{value:!0});X.default=Fe;var ne=/^[^\\]?(?:\\(?:[\da-f]{1,6}\s?|.)|[\w\-\u00b0-\uFFFF])+/,qe=/\\([\da-f]{1,6}\s?|(\s)|.)/gi,Ve=/^\s*((?:\\.|[\w\u00b0-\uFFFF-])+)\s*(?:(\S?)=\s*(?:(['"])([^]*?)\3|(#?(?:\\.|[\w\u00b0-\uFFFF-])*)|)|)\s*(i)?\]/,Ue={undefined:"exists","":"equals","~":"element","^":"start",$:"end","*":"any","!":"not","|":"hyphen"},se={">":"child","<":"parent","~":"sibling","+":"adjacent"},ie={"#":["id","equals"],".":["class","element"]},Be=new Set(["has","not","matches"]),We=new Set(["contains","icontains"]),ae=new Set(['"',"'"]);function Xe(e,t,r){var n=parseInt(t,16)-65536;return n!==n||r?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,n&1023|56320)}function I(e){return e.replace(qe,Xe)}function oe(e){return e===" "||e===`
`||e==="	"||e==="\f"||e==="\r"}function Fe(e,t){var r=[];if(e=le(r,""+e,t),e!=="")throw new Error("Unmatched selector: "+e);return r}function le(e,t,r){var n=[],i=!1;function s(){var T=t.match(ne);if(!T)throw new Error("Expected name, found "+t);var D=T[0];return t=t.substr(D.length),I(D)}function a(T){for(;oe(t.charAt(T));)T++;t=t.substr(T)}function o(T){for(var D=0;t.charAt(--T)==="\\";)D++;return(D&1)===1}for(a(0);t!=="";){var c=t.charAt(0);if(oe(c))i=!0,a(1);else if(c in se)n.push({type:se[c]}),i=!1,a(1);else if(c===","){if(n.length===0)throw new Error("Empty sub-selector");e.push(n),n=[],i=!1,a(1)}else if(i&&(n.length>0&&n.push({type:"descendant"}),i=!1),c==="*")t=t.substr(1),n.push({type:"universal"});else if(c in ie){var d=ie[c],p=d[0],y=d[1];t=t.substr(1),n.push({type:"attribute",name:p,action:y,value:s(),ignoreCase:!1})}else if(c==="["){t=t.substr(1);var l=t.match(Ve);if(!l)throw new Error("Malformed attribute selector: "+t);t=t.substr(l[0].length);var j=I(l[1]);(!r||("lowerCaseAttributeNames"in r?r.lowerCaseAttributeNames:!r.xmlMode))&&(j=j.toLowerCase()),n.push({type:"attribute",name:j,action:Ue[l[2]],value:I(l[4]||l[5]||""),ignoreCase:!!l[6]})}else if(c===":"){if(t.charAt(1)===":"){t=t.substr(2),n.push({type:"pseudo-element",name:s().toLowerCase()});continue}t=t.substr(1);var x=s().toLowerCase(),l=null;if(t.charAt(0)==="(")if(Be.has(x)){var E=t.charAt(1),P=ae.has(E);if(t=t.substr(P?2:1),l=[],t=le(l,t,r),P){if(t.charAt(0)!==E)throw new Error("Unmatched quotes in :"+x);t=t.substr(1)}if(t.charAt(0)!==")")throw new Error("Missing closing parenthesis in :"+x+" ("+t+")");t=t.substr(1)}else{for(var b=1,H=1;H>0&&b<t.length;b++)t.charAt(b)==="("&&!o(b)?H++:t.charAt(b)===")"&&!o(b)&&H--;if(H)throw new Error("Parenthesis not matched");if(l=t.substr(1,b-2),t=t.substr(b),We.has(x)){var E=l.charAt(0);E===l.slice(-1)&&ae.has(E)&&(l=l.slice(1,-1)),l=I(l)}}n.push({type:"pseudo",name:x,data:l})}else if(ne.test(t)){var B=s();(!r||("lowerCaseTags"in r?r.lowerCaseTags:!r.xmlMode))&&(B=B.toLowerCase()),n.push({type:"tag",name:B})}else return n.length&&n[n.length-1].type==="descendant"&&n.pop(),ce(e,n),t}return ce(e,n),t}function ce(e,t){if(e.length>0&&t.length===0)throw new Error("Empty sub-selector");e.push(t)}});var de=C(G=>{"use strict";Object.defineProperty(G,"__esModule",{value:!0});var ze={equals:"",element:"~",start:"^",end:"$",any:"*",not:"!",hyphen:"|"};function ue(e){return e.map(Ge).join(", ")}G.default=ue;function Ge(e){return e.map(Ye).join("")}function Ye(e){switch(e.type){case"child":return" > ";case"parent":return" < ";case"sibling":return" ~ ";case"adjacent":return" + ";case"descendant":return" ";case"universal":return"*";case"tag":return m(e.name);case"pseudo-element":return"::"+m(e.name);case"pseudo":return e.data===null?":"+m(e.name):typeof e.data=="string"?":"+m(e.name)+"("+e.data+")":":"+m(e.name)+"("+ue(e.data)+")";case"attribute":return e.action==="exists"?"["+m(e.name)+"]":e.name==="id"&&e.action==="equals"&&!e.ignoreCase?"#"+m(e.value):e.name==="class"&&e.action==="element"&&!e.ignoreCase?"."+m(e.value):"["+m(e.name)+ze[e.action]+"='"+m(e.value)+"'"+(e.ignoreCase?"i":"")+"]";default:throw new Error("Unknown type")}}function m(e){return e}});var he=C(g=>{"use strict";var Je=g&&g.__createBinding||(Object.create?function(e,t,r,n){n===void 0&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}),Qe=g&&g.__exportStar||function(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&Je(t,e,r)};Object.defineProperty(g,"__esModule",{value:!0});Qe(z(),g);var Ze=z();Object.defineProperty(g,"parse",{enumerable:!0,get:function(){return Ze.default}});var Ke=de();Object.defineProperty(g,"stringify",{enumerable:!0,get:function(){return Ke.default}})});var fe=C((Lt,pe)=>{const et=/([^=\s]+)(\s*=\s*(("([^"]*)")|('([^']*)')|[^>\s]+))?/gm,tt=/^<\/([^>\s]+)[^>]*>/m,rt=/^<([^>\s\/]+)((\s+[^=>\s]+(\s*=\s*(("[^"]*")|('[^']*')|[^>\s]+))?)*)\s*\/?\s*>/m,nt=/\s*\/\s*>\s*$/m,k=e=>{throw new Error(`Must implement the method ${e||""}`)};class w{constructor(e){e=e||{},e.scanner&&(this.scanner=e.scanner,e.scanner=null),this.options=Object.assign({},w.defaults,e)}parse(e){let t=!1,r,n,i;for(;e.length;)e.substring(0,4)==="<!--"?(r=e.indexOf("-->"),r!==-1?(this.scanner.comment(e.substring(4,r)),e=e.substring(r+3),t=!1):t=!0):e.substring(0,2)==="</"?(n=this.endTagRe.exec(e),n?(e=RegExp.rightContext,t=!1,this.parseEndTag(RegExp.lastMatch,n[1])):t=!0):e.charAt(0)==="<"&&(n=this.startTagRe.exec(e),n?(e=RegExp.rightContext,t=!1,this.parseStartTag(RegExp.lastMatch,n[1],n)):t=!0),t&&(r=e.indexOf("<"),r===0&&(r=e.substring(1).indexOf("<")),r===-1?(i=e,e=""):(i=e.substring(0,r),e=e.substring(r)),(!this.options.ignoreWhitespaceText||!/^\s*$/.test(i))&&this.scanner.characters(i)),t=!0,n=null}parseStartTag(e,t,r){const n=nt.test(e);let i=r[2];n&&(i=i.replace(/\s*\/\s*$/,""));const s=this.parseAttributes(t,i);this.scanner.startElement(t,s,n,r[0])}parseEndTag(e,t){this.scanner.endElement(t)}parseAttributes(e,t){const r={};return t.replace(this.attrRe,(n,i,s,a,o,c,d,p)=>{r[i]=p||c||a||!0}),r}}w.defaults={ignoreWhitespaceText:!1};w.prototype.attrRe=et;w.prototype.endTagRe=tt;w.prototype.startTagRe=rt;w.prototype.scanner={startElement(){k("startElement")},endElement(){k("endElement")},characters(){k("characters")},comment(){k("comment")}};pe.exports=w});var Ne=C((A,me)=>{const Y=1,st=3,it=8,at=9,ge=10;class J{constructor({tagName:e,nodeType:t,attrs:r,textContent:n,parentNode:i,childNodes:s}){this.tagName=e,this.nodeType=t,this.textContent=n,this.parentNode=i,this.attrs=r,this.childNodes=s||[],t===Y&&(r.id&&(this.id=r.id),r.class&&(this.className=r.class))}appendChild(e){e&&(e.parentNode=this,this.childNodes.push(e))}insertAfter(e,t){if(!t)return this.appendChild(e);this.childNodes.some((r,n)=>{if(r===t)return e.parentNode=this,this.childNodes.splice(n,0,e),!0})}insertBefore(e,t){if(!t)return this.appendChild(e);this.childNodes.some((r,n)=>{if(r===t)return e.parentNode=this,n===0?this.childNodes.unshift(e):this.childNodes.splice(n-1,0,e),!0})}toJSON(){const e={tagName:this.tagName,nodeType:this.nodeType};return this.childNodes.length&&(e.childNodes=this.childNodes),this.textContent&&(e.textContent=this.textContent),this.attrs&&(e.attrs=this.attrs),this.id&&(e.id=this.id),this.className&&(e.className=this.className),e}getElementsByTagName(e){}getElementsByClassName(e){}}A=me.exports=J;A.NODE_TYPE={ELEMENT_NODE:Y,TEXT_NODE:st,COMMENT_NODE:it,DOCUMENT_NODE:at,DOCUMENT_TYPE_NODE:ge};class ot extends J{constructor(e){super(e);this.id=void 0,this.nodeType=ge,this.systemId=e.systemId||"",this.publicId=e.publicId||"",this.name=e.name||"html"}toJSON(){return{tagName:this.tagName,nodeType:this.nodeType,publicId:this.publicId,systemId:this.systemId,name:this.name}}}class lt extends J{getElementById(e){if(!e)return null;return t(this.childNodes);function t(r){let n;return r.some(i=>i.nodeType!==Y?!1:i.id===e?n=i:n=t(i.childNodes)),n}}}A.DoctypeNode=ot;A.DocumentNode=lt});var Ee=C((jt,ye)=>{const S=Ne(),{ELEMENT_NODE:ct,TEXT_NODE:ut,COMMENT_NODE:dt,DOCUMENT_NODE:ht,DOCUMENT_TYPE_NODE:pt}=S.NODE_TYPE,{DoctypeNode:ft,DocumentNode:mt}=S,gt=/^\s*<!doctype\s+(html)(\s+public(\s+('[^']+'|"[^"]+"))?(\s+('[^']+'|"[^"]+"))?)?\s*/i,_={doctype(e,t,r,n,i){const s=e.path[e.path.length-1],a=gt.exec(i)||[],o=new ft({tagName:"doctype",nodeType:pt,parentNode:s,name:a[1],publicId:a[4]&&a[4].substring(1,a[4].length-1),systemId:a[6]&&a[6].substring(1,a[6].length-1)});s.appendChild(o)},_default(e,t,r,n,i){const s=e.path[e.path.length-1],a=new S({tagName:t,nodeType:ct,attrs:r,parentNode:s});s.appendChild(a),n||e.path.push(a)},_selfCloseTag(e,t,r,n,i){_._default(e,t,r,!0,i)}};_["!doctype"]=_.doctype;["area","base","link","br","hr","col","command","embed","img","input","keygen","meta","param","source","track","wbr"].forEach(e=>{_[e]=_._selfCloseTag});class Nt{constructor(){this.reset()}reset(){this.rootNode=new mt({tagName:"document",nodeType:ht}),this.path=[this.rootNode]}getRootNode(){return this.rootNode}startElement(e,t,r,n){return e=e.toLowerCase(),_[e]?_[e](this,e,t,r,n):_._default(this,e,t,r,n)}endElement(e){this.path.pop()}characters(e){if(/^\s*$/.test(e))return;const t=this.path[this.path.length-1],r=new S({tagName:"text",nodeType:ut,textContent:e,parentNode:t});t.appendChild(r)}comment(e){const t=this.path[this.path.length-1],r=new S({tagName:"comment",nodeType:dt,textContent:e,parentNode:t});t.appendChild(r)}}ye.exports=Nt});var xe=C((R,be)=>{const Te=fe(),_e=Ee();class yt extends Te{constructor(e){e=e||{},e.scanner||(e.scanner=new _e),super(e)}parse(e){super.parse(e);const t=this.scanner.getRootNode();return this.scanner.reset(),t}}R=be.exports=yt;R.RawHtmlParser=Te;R.HtmlScanner=_e});function Et(e,t,r,n){if(typeof t=="function")return t.call(null,{props:{...r,children:n},attrs:r,children:n,h:e.h,context:e});{let i;if(t?t.toLowerCase()==="fragment"?i=e.document.createDocumentFragment():i=e.document.createElement(t):i=e.document.createElement("div"),r)for(let[s,a]of Object.entries(r))s&&typeof s=="string"&&(s=s.toLowerCase()),s==="classname"?i.className=a:s==="on"?Object.entries(a).forEach(([o,c])=>{i.setAttribute("on"+o,c)}):a!==!1&&a!=null&&(a===!0?i.setAttribute(s,s):i.setAttribute(s,a.toString()));if(n)for(const s of n){let a=Array.isArray(s)?[...s]:[s];for(let o of a)o&&(o!==!1&&o!=null&&(typeof o!="object"?i.appendChild(e.document.createTextNode(o.toString())):i.appendChild(o)))}return i}}function O(e,t,...r){return typeof e=="object"&&(e="fragment",r=e.children,t=e.attrs),Array.isArray(t)?(r=t,t={}):t?t.attrs&&(t={...t.attrs,...t},delete t.attrs):t={},{tag:e,attrs:t,children:r.flat(Infinity)}}function Q(e){return e.h=function(r,n,...i){let{tag:s,attrs:a,children:o}=O(r,n,i);return Et(e,s,a,o)},e.h}function M(e){return e&&e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/'/g,"&apos;").replace(/"/g,"&quot;")}function Ce(e){return e&&e.replace(/&lt;/gi,"<").replace(/&gt;/gi,">").replace(/&quot;/gi,'"').replace(/&apos;/gi,"'").replace(/&amp;/gi,"&")}const Z=["area","base","br","col","embed","hr","img","input","keygen","link","meta","param","source","track","wbr","command"];let L=[];function we(e){return e="<![CDATA["+e+"]]>",L.push(e),e}function K(e,t,r,n){const i=n&&n.length>0;let s="";if(t=t.replace(/__/g,":"),t!=="noop"){t!=="cdata"?s+=`<${t}`:s+="<![CDATA[";for(let a in r)if(a&&r.hasOwnProperty(a)){let o=r[a];if(a==="html")continue;a.toLowerCase()==="classname"&&(a="class"),a=a.replace(/__/g,":"),o===!0?s+=` ${a}="${a}"`:a==="style"&&typeof o=="object"?s+=` ${a}="${Object.keys(o).filter(c=>o[c]!=null).map(c=>{let d=o[c];return d=typeof d=="number"?d+"px":d,`${c.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}:${d}`}).join(";")}"`:o!==!1&&o!=null&&(s+=` ${a}="${M(o.toString())}"`)}if(t!=="cdata"){if(e&&!i)return s+=" />",L.push(s),s;s+=">"}if(!e&&Z.includes(t))return L.push(s),s}if(i){for(let a of n)if(a!=null&&a!==!1){Array.isArray(a)||(a=[a]);for(let o of a)L.indexOf(o)!==-1||t==="script"||t==="style"?s+=o:s+=M(o.toString())}}return r.html&&(s+=r.html),t!=="noop"&&(t!=="cdata"?s+=`</${t}>`:s+="]]>"),L.push(s),s}function f(e,t,...r){let{tag:n,attrs:i,children:s}=O(e,t,r);return K(!1,n,i,s)}f.firstLine="<!DOCTYPE html>";f.html=!0;const ve=$e(he());let Oe={};function bt(e){let t=Oe[e];return t==null&&(t=ve.parse(e),Oe[e]=t),t}function De(e,t,{debug:r=!1}={}){for(let i of bt(e)){r&&(console.log("Selector:",e),console.log("Rules:",i),console.log("Element:",t));function n(s,a){let o=!1;for(let c of a){const{type:d,name:p,action:y,value:l,ignoreCase:j=!0,data:x}=c;if(d==="attribute")y==="equals"?(o=s.getAttribute(p)===l,r&&console.log("Attribute equals",o)):y==="start"?(o=s.getAttribute(p)?.startsWith(l),r&&console.log("Attribute start",o)):y==="end"?(o=s.getAttribute(p)?.endsWith(l),r&&console.log("Attribute start",o)):y==="element"?p==="class"?(o=s.classList.contains(l),r&&console.log("Attribute class",o)):(o=s.getAttribute(p)?.includes(l),r&&console.log("Attribute element",o)):y==="exists"?(o=s.hasAttribute(p),r&&console.log("Attribute exists",o)):console.warn("Unknown CSS selector action",y);else if(d==="tag")o=s.tagName===p.toUpperCase(),r&&console.log("Is tag",o);else if(d==="universal")o=!0,r&&console.log("Is universal",o);else if(d==="pseudo"){if(p==="not"){let E=!0;x.forEach(P=>{n(s,P)||(E=!1)}),o=!E}r&&console.log("Is :not",o)}else console.warn("Unknown CSS selector type",d,e,a);if(!o)break}return o}if(n(t,i))return!0}return!1}const Tt=Symbol.for("nodejs.util.inspect.custom");let Ae={fontWeight:"bold"},Se={fontStyle:"italic"},Me={backgroundColor:"rgb(255, 250, 165)"},Le={textDecorations:"underline"},ee={textDecorations:"line-through"},_t={b:Ae,strong:Ae,em:Se,i:Se,mark:Me,u:Le,a:Le,s:ee,del:ee,ins:Me,strike:ee};class u{static ELEMENT_NODE=1;static TEXT_NODE=3;static CDATA_SECTION_NODE=4;static PROCESSING_INSTRUCTION_NODE=7;static COMMENT_NODE=8;static DOCUMENT_NODE=9;static DOCUMENT_TYPE_NODE=10;static DOCUMENT_FRAGMENT_NODE=11;get nodeType(){return console.error("Subclasses should define nodeType!"),0}get nodeName(){return console.error("Subclasses should define nodeName!"),""}get nodeValue(){return null}constructor(){this._parentNode=null,this._childNodes=[]}cloneNode(e=!1){let t=new this.constructor;return e&&(t._childNodes=this._childNodes.map(r=>r.cloneNode(!0)),t._fixChildNodesParent()),t}_fixChildNodesParent(){this._childNodes.forEach(e=>e._parentNode=this)}insertBefore(e,t=null){if(e!==t){let r=t?this._childNodes.indexOf(t):0;r<0&&(r=0),this._childNodes.splice(r,0,e),this._fixChildNodesParent()}}appendChild(e){if(e===this){console.warn("Cannot appendChild to self");return}if(e instanceof $&&console.warn("No defined how to append a document to a node!",e),e instanceof v)for(let t of[...e._childNodes])this.appendChild(t);else if(Array.isArray(e))for(let t of[...e])this.appendChild(t);else if(e instanceof u)e.remove(),this._childNodes.push(e);else try{const t=typeof e=="string"?e:JSON.stringify(e,null,2);this._childNodes.push(new h(t))}catch(t){console.error(`The data ${e} to be added to ${this.render()} is problematic: ${t}`)}this._fixChildNodesParent()}removeChild(e){let t=this._childNodes.indexOf(e);t>=0&&(e._parentNode=null,this._childNodes.splice(t,1),this._fixChildNodesParent())}remove(){return this?.parentNode?.removeChild(this),this}replaceChildren(...e){this._childNodes=e.map(t=>typeof t=="string"?new h(t):t.remove()),this._fixChildNodesParent()}replaceWith(...e){let t=this._parentNode;if(t){let r=this._indexInParent();r>=0&&(e=e.map(n=>typeof n=="string"?new h(n):n.remove()),t._childNodes.splice(r,1,...e),this._parentNode=null,t._fixChildNodesParent())}}_indexInParent(){return this._parentNode?this._parentNode.childNodes.indexOf(this):-1}get parentNode(){return this._parentNode}get childNodes(){return this._childNodes||[]}get children(){return this._childNodes||[]}get firstChild(){return this._childNodes[0]}get lastChild(){return this._childNodes[this._childNodes.length-1]}get nextSibling(){let e=this._indexInParent();return e!=null&&this.parentNode.childNodes[e+1]||null}get previousSibling(){let e=this._indexInParent();return e>0&&this.parentNode.childNodes[e-1]||null}flatten({condition:e=t=>t instanceof N}={}){let t=[];e(this)&&t.push(this);for(let r of this._childNodes)t.push(...r.flatten({condition:e}));return t}render(){return""}get textContent(){return this._childNodes.map(e=>e.textContent).join("")}set textContent(e){this._childNodes=[],e&&this.appendChild(new h(e.toString()))}contains(e){return e===this?!0:this._childNodes.some(t=>t.contains(e))}get ownerDocument(){return this.nodeType===u.DOCUMENT_NODE||this.nodeType===u.DOCUMENT_FRAGMENT_NODE?this:this?._parentNode?.ownerDocument}toString(){return`${this.nodeName}`}[Tt](){return`${this.constructor.name} "${this.render()}"`}}class h extends u{get nodeType(){return u.TEXT_NODE}get nodeName(){return"#text"}get nodeValue(){return this._text||""}get textContent(){return this.nodeValue}constructor(e=""){super();this._text=e}render(){return this._text}cloneNode(e=!1){let t=super.cloneNode(e);return t._text=this._text,t}}class te extends u{getElementById(e){return this.flatten().find(t=>t._attributes.id===e)}getElementsByClassName(e){return this.flatten().filter(t=>t.classList.contains(e))}matches(e){return De(e,this)}querySelectorAll(e){return this.flatten().filter(t=>t.matches(e))}querySelector(e){return this.flatten().find(t=>t.matches(e))}parent(e){return this.matches(e)?this:this.parentNode==null?null:this.parentNode?.parent(e)}handle(e,t){let r=0;for(let n of this.querySelectorAll(e))t(n,r++)}}class N extends te{get nodeType(){return u.ELEMENT_NODE}get nodeName(){return this._nodeName}constructor(e="div",t={}){super();this._nodeName=(e||"").toUpperCase(),this._attributes=t||{},this._styles=null}cloneNode(e=!1){let t=super.cloneNode(e);return t._nodeName=this._nodeName,t._attributes=Object.assign({},this._attributes),t}get attributes(){return this._attributes}setAttribute(e,t){this._attributes[e]=t,this._styles=null}getAttribute(e){return this._attributes[e]}removeAttribute(e){delete this._attributes[e]}hasAttribute(e){return this._attributes[e]!=null}get style(){if(this._styles==null){let e=Object.assign({},_t[this.tagName.toLowerCase()]||{}),t=this.getAttribute("style");if(t){let r,n=/\s*([\w-]+)\s*:\s*([^;]+)/g;for(;r=n.exec(t);){let i=r[1],s=r[2].trim();e[i]=s;let a=o=>o.replace(/[A-Z]/g,"-$&").toLowerCase();e[a]=s}}this._styles=e}return this._styles}get tagName(){return this._nodeName}get id(){return this._attributes.id}set id(e){this._attributes.id=e}get src(){return this._attributes.src}set src(e){this._attributes.src=e}getElementsByTagName(e){e=e.toUpperCase();let t=this.flatten();return e!=="*"?t.filter(r=>r.tagName===e):t}get innerHTML(){return this._childNodes.map(e=>e.render(f)).join("")}set innerHTML(e){if(this.setInnerHTML)this.setInnerHTML(e);else throw"set innerHTML not implemented"}get outerHTML(){return this.render(f)}get className(){return this._attributes.class||""}set className(e){Array.isArray(e)?e=e.filter(t=>!!t).join(" "):typeof e=="object"&&(e=Object.entries(e).filter(([t,r])=>!!r).map(([t,r])=>t).join(" ")),this._attributes.class=e}get classList(){let e=this,t=(this.className||"").trim().split(/\s+/g)||[];return{contains(r){return t.includes(r)},add(r){t.includes(r)||(t.push(r),e.className=t)},remove(r){let n=t.indexOf(r);n>=0&&(t.splice(n,1),e.className=t)}}}render(e=f){return e(this.tagName.toLowerCase(),this.attributes,this.childNodes.map(t=>t.render(e)))}}class v extends te{get nodeType(){return u.DOCUMENT_FRAGMENT_NODE}get nodeName(){return"#document-fragment"}render(e=f){return this._childNodes.map(t=>t.render(e)||[]).join("")}get innerHTML(){return this._childNodes.map(e=>e.render(f)).join("")}createElement(e,t={}){return new N(e,t)}createDocumentFragment(){return new v}createTextNode(e){return new h(e)}}class $ extends v{get nodeType(){return u.DOCUMENT_NODE}get nodeName(){return"#document"}get documentElement(){return this.firstChild}}class je extends ${constructor(){super();let e=new N("html"),t=new N("body"),r=new N("head"),n=new N("title");e.appendChild(r),r.appendChild(n),e.appendChild(t),this.appendChild(e)}get body(){return this.querySelector("body")}get title(){return this.querySelector("title")?.textContent}set title(e){this.querySelector("title").textContent=e}get head(){return this.querySelector("head")}render(e=f){let t=super.render(e);return e.firstLine&&(t=e.firstLine+`
`+t),t}}function Pe(){return new $}function xt(){return new je}let F=Pe(),Ct=Q({document:F});const wt=xe(),vt=wt.RawHtmlParser;function V(e=null){return e instanceof u?e:(e instanceof Buffer&&(e=e.toString("utf-8")),typeof e=="string"?q(e):new v)}function q(e){let t=new v,r=[t],n=new vt({scanner:{startElement(i,s,a){let o=r[r.length-1];const c=F.createElement(i,s);o.appendChild(c),Z.includes(i.toLowerCase())||a||r.push(c)},endElement(i){r.pop()},characters(i){let s=r[r.length-1];s?.lastChild?.nodeType===u.TEXT_NODE?s.lastChild._text+=i:s.appendChild(new h(i))},comment(i){}}});return n.parse(e),t}N.prototype.setInnerHTML=function(e){let t=q(e);this._childNodes=t._childNodes,this._fixChildNodesParent()};function Ot(e){let t=e.querySelector("head"),r=e.querySelector("body");return(r||t)&&(e=V(),t&&e.appendChild(t.childNodes),r&&e.appendChild(r.children)),e}function re(e){let t="";for(;e.parentNode;)t+="  ",e=e.parentNode;return t.substr(2)}function He(e,t){let r="meta,link,script,p,h1,h2,h3,h4,h5,h6,blockquote,div,ul,ol,li,article,section,footer,head,body,title,nav,section,article,hr,form";e.handle(r,n=>{let i=n;for(;i;){if(["PRE","CODE","SCRIPT","STYLE","TT"].includes(i.tagName))return;i=i.parentNode}let s=n.previousSibling;(!s||s.nodeType!==u.TEXT_NODE||!s.nodeValue?.endsWith(`
`))&&n.parentNode?.insertBefore(new h(`
`),n),n.parentNode?.insertBefore(new h(re(n)),n);let a=n.nextSibling;if((!a||a.nodeType!==u.TEXT_NODE||!a.nodeValue?.startsWith(`
`))&&(a?n.parentNode?.insertBefore(new h(`
`),a):n.parentNode?.appendChild(new h(`
`))),n.childNodes.length){let o=n.firstChild;o.nodeType===u.TEXT_NODE&&n.insertBefore(new h(`
`+re(n)+"  ")),n.appendChild(new h(`
`+re(n)))}})}function U(e,t,...r){let{tag:n,attrs:i,children:s}=O(e,t,r);return K(!0,n,i,s)}U.firstLine='<?xml version="1.0" encoding="utf-8"?>';U.xml=!0;export{we as CDATA,$ as VDocument,v as VDocumentFragment,N as VElement,je as VHTMLDocument,u as VNode,te as VNodeQuery,h as VTextNode,Pe as createDocument,xt as createHTMLDocument,F as document,M as escapeHTML,Ct as h,O as hArgumentParser,Q as hFactory,f as html,q as parseHTML,Ot as removeBodyContainer,He as tidyDOM,Ce as unescapeHTML,V as vdom,U as xml};
