{
  "version": 3,
  "sources": ["src/h.js"],
  "sourcesContent": ["// Copyright (c) 2020 Dirk Holtwick. All rights reserved. https://holtwick.de/copyright\n\n/*\n * Abstraction for h/jsx like DOM descriptions.\n * It is used in DOM, VDOM\n *\n */\n\nconst log = require('debug')('hostic:h')\n\nfunction _h(context, tag, attrs, children) {\n  // console.log('_h', { context, tag, attrs, children })\n  if (typeof tag === 'function') {\n    return tag.call(null, {\n      props: { ...attrs, children },\n      attrs,\n      children,\n      h: context.h,\n      context,\n    })\n  } else {\n    let el\n    if (tag) {\n      if (tag.toLowerCase() === 'fragment') {\n        el = context.document.createDocumentFragment()\n      } else {\n        el = context.document.createElement(tag)\n      }\n    } else {\n      el = context.document.createElement('div')\n    }\n    if (attrs) {\n      for (let [key, value] of Object.entries(attrs)) {\n        if (key && typeof key === 'string') {\n          key = key.toLowerCase()\n        }\n        if (key === 'classname') {\n          el.className = value\n        } else if (key === 'on') {\n          Object.entries(value).forEach(([name, value]) => {\n            el.setAttribute('on' + name, value)\n          })\n          // else if (key.indexOf('on') === 0) {\n          //   if (el.addEventListener) {\n          //     el.addEventListener(key.substring(2), value)\n          //     continue\n          //   }\n        } else if (value !== false && value != null) {\n          if (value === true) {\n            el.setAttribute(key, key)\n          } else {\n            el.setAttribute(key, value.toString())\n          }\n        }\n      }\n    }\n    if (children) {\n      for (const childOuter of children) {\n        let cc = Array.isArray(childOuter) ? [...childOuter] : [childOuter]\n        for (let child of cc) {\n          if (child) {\n            if (child !== false && child != null) {\n              if (typeof child !== 'object') {\n                el.appendChild(context.document.createTextNode(child.toString()))\n              } else {\n                el.appendChild(child)\n              }\n            }\n          }\n        }\n      }\n    }\n    return el\n  }\n}\n\nexport function hArgumentParser(tag, attrs, ...children) {\n  // console.log('parser', { tag, attrs, children })\n  if (typeof tag === 'object') {\n    tag = 'fragment'\n    children = tag.children\n    attrs = tag.attrs\n  }\n  if (Array.isArray(attrs)) {\n    children = attrs\n    attrs = {}\n  } else if (attrs) {\n    if (attrs.attrs) {\n      attrs = { ...attrs.attrs, ...attrs }\n      delete attrs.attrs\n    }\n  } else {\n    attrs = {}\n  }\n  return {\n    tag,\n    attrs,\n    children: children.flat(Infinity),\n  }\n}\n\n// global.hh = function (...args) {\n//   console.log('hh', args)\n// }\n\nexport function hFactory(context) {\n  // let context = { document }\n  context.h = function h(itag, iattrs, ...ichildren) {\n    let { tag, attrs, children } = hArgumentParser(itag, iattrs, ichildren)\n    return _h(context, tag, attrs, children)\n  }\n  return context.h\n}\n"],
  "mappings": "AAQA,MAAM,MAAM,QAAQ,SAAS;AAE7B,YAAY,SAAS,KAAK,OAAO;AAE/B,MAAI,OAAO,QAAQ;AACjB,WAAO,IAAI,KAAK,MAAM;AAAA,MACpB,OAAO,IAAK,OAAO;AAAA,MACnB;AAAA,MACA;AAAA,MACA,GAAG,QAAQ;AAAA,MACX;AAAA;AAAA;AAGF,QAAI;AACJ,QAAI;AACF,UAAI,IAAI,kBAAkB;AACxB,aAAK,QAAQ,SAAS;AAAA;AAEtB,aAAK,QAAQ,SAAS,cAAc;AAAA;AAAA;AAGtC,WAAK,QAAQ,SAAS,cAAc;AAAA;AAEtC,QAAI;AACF,eAAS,CAAC,KAAK,UAAU,OAAO,QAAQ;AACtC,YAAI,OAAO,OAAO,QAAQ;AACxB,gBAAM,IAAI;AAAA;AAEZ,YAAI,QAAQ;AACV,aAAG,YAAY;AAAA,mBACN,QAAQ;AACjB,iBAAO,QAAQ,OAAO,QAAQ,CAAC,CAAC,MAAM;AACpC,eAAG,aAAa,OAAO,MAAM;AAAA;AAAA,mBAOtB,UAAU,SAAS,SAAS;AACrC,cAAI,UAAU;AACZ,eAAG,aAAa,KAAK;AAAA;AAErB,eAAG,aAAa,KAAK,MAAM;AAAA;AAAA;AAAA;AAAA;AAKnC,QAAI;AACF,iBAAW,cAAc;AACvB,YAAI,KAAK,MAAM,QAAQ,cAAc,CAAC,GAAG,cAAc,CAAC;AACxD,iBAAS,SAAS;AAChB,cAAI;AACF,gBAAI,UAAU,SAAS,SAAS;AAC9B,kBAAI,OAAO,UAAU;AACnB,mBAAG,YAAY,QAAQ,SAAS,eAAe,MAAM;AAAA;AAErD,mBAAG,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAO3B,WAAO;AAAA;AAAA;AAIJ,gCAAyB,KAAK,UAAU;AAE7C,MAAI,OAAO,QAAQ;AACjB,UAAM;AACN,eAAW,IAAI;AACf,YAAQ,IAAI;AAAA;AAEd,MAAI,MAAM,QAAQ;AAChB,eAAW;AACX,YAAQ;AAAA,aACC;AACT,QAAI,MAAM;AACR,cAAQ,IAAK,MAAM,UAAU;AAC7B,aAAO,MAAM;AAAA;AAAA;AAGf,YAAQ;AAAA;AAEV,SAAO;AAAA,IACL;AAAA,IACA;AAAA,IACA,UAAU,SAAS,KAAK;AAAA;AAAA;AAQrB,yBAAkB;AAEvB,UAAQ,IAAI,WAAW,MAAM,WAAW;AACtC,QAAI,CAAE,KAAK,OAAO,YAAa,gBAAgB,MAAM,QAAQ;AAC7D,WAAO,GAAG,SAAS,KAAK,OAAO;AAAA;AAEjC,SAAO,QAAQ;AAAA;",
  "names": []
}
