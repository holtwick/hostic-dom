{
  "version": 3,
  "sources": ["src/tidy.js"],
  "sourcesContent": ["import { VNode } from './vdom.js'\nimport { VTextNode } from './vdom.js'\n\nfunction level(element) {\n  let indent = ''\n  while (element.parentNode) {\n    indent += '  '\n    element = element.parentNode\n  }\n  return indent.substr(2)\n}\n\nexport function tidyDOM(document, opt) {\n  let selector = 'meta,link,script,p,h1,h2,h3,h4,h5,h6,blockquote,div,ul,ol,li,article,section,footer,head,body,title,nav,section,article,hr,form'\n  document.handle(selector, e => {\n\n    // Ignore if inside PRE etc.\n    let ee = e\n    while (ee) {\n      if (['PRE', 'CODE', 'SCRIPT', 'STYLE', 'TT'].includes(ee.tagName)) return\n      ee = ee.parentNode\n    }\n\n    let prev = e.previousSibling\n    if (!prev || prev.nodeType !== VNode.TEXT_NODE || !prev.nodeValue?.endsWith('\\n')) {\n      e.parentNode?.insertBefore(new VTextNode('\\n'), e)\n    }\n    e.parentNode?.insertBefore(new VTextNode(level(e)), e)\n\n    let next = e.nextSibling\n    if (!next || next.nodeType !== VNode.TEXT_NODE || !next.nodeValue?.startsWith('\\n')) {\n      if (next) {\n        e.parentNode?.insertBefore(new VTextNode('\\n'), next)\n      } else {\n        e.parentNode?.appendChild(new VTextNode('\\n'))\n      }\n    }\n\n    if (e.childNodes.length) {\n      let first = e.firstChild\n      if (first.nodeType === VNode.TEXT_NODE) {\n        e.insertBefore(new VTextNode('\\n' + level(e) + '  '))\n      }\n      e.appendChild(new VTextNode('\\n' + level(e)))\n    }\n\n  })\n\n}\n"],
  "mappings": "AAAA;AACA;AAEA,eAAe;AACb,MAAI,SAAS;AACb,SAAO,QAAQ;AACb,cAAU;AACV,cAAU,QAAQ;AAAA;AAEpB,SAAO,OAAO,OAAO;AAAA;AAGhB,wBAAiB,UAAU;AAChC,MAAI,WAAW;AACf,WAAS,OAAO,UAAU;AAd5B;AAiBI,QAAI,KAAK;AACT,WAAO;AACL,UAAI,CAAC,OAAO,QAAQ,UAAU,SAAS,MAAM,SAAS,GAAG;AAAU;AACnE,WAAK,GAAG;AAAA;AAGV,QAAI,OAAO,EAAE;AACb,QAAI,CAAC,QAAQ,KAAK,aAAa,MAAM,aAAa,CAAC,YAAK,cAAL,mBAAgB,SAAS;AAC1E,cAAE,eAAF,mBAAc,aAAa,IAAI,UAAU,OAAO;AAAA;AAElD,YAAE,eAAF,mBAAc,aAAa,IAAI,UAAU,MAAM,KAAK;AAEpD,QAAI,OAAO,EAAE;AACb,QAAI,CAAC,QAAQ,KAAK,aAAa,MAAM,aAAa,CAAC,YAAK,cAAL,mBAAgB,WAAW;AAC5E,UAAI;AACF,gBAAE,eAAF,mBAAc,aAAa,IAAI,UAAU,OAAO;AAAA;AAEhD,gBAAE,eAAF,mBAAc,YAAY,IAAI,UAAU;AAAA;AAAA;AAI5C,QAAI,EAAE,WAAW;AACf,UAAI,QAAQ,EAAE;AACd,UAAI,MAAM,aAAa,MAAM;AAC3B,UAAE,aAAa,IAAI,UAAU,OAAO,MAAM,KAAK;AAAA;AAEjD,QAAE,YAAY,IAAI,UAAU,OAAO,MAAM;AAAA;AAAA;AAAA;",
  "names": []
}
